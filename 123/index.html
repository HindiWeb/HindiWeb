<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HindiWeb - 123</title>
    <meta name="description" content="HindiWeb.github.io/123 is a math game for childern. Just hit the click and get to us to Play. it's simple like 123."/>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://HindiWeb.github.io/lib/Upopup/2.5/popup.min.js"></script>
    <!-- <script src="/Ex/Upopup-2.5.0.js"></script> -->
    <!-- <script src="/Ex/jquery-3.7.1.min.js"></script> -->
    <!-- <link rel="stylesheet" href="/Ex/css/all.min.css"> -->
    <!-- <link rel="stylesheet" href="/Ex/css/bootstrap-icons.min.css"> -->
    <link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css'>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    
    <link rel="manifest" href="manifest.json">
    <style>
        * {
            box-sizing: border-box;
        }
        .container {
            max-width: 400px;
            margin: auto;
        }
        .QnA {
            text-align: center;
            padding: 7px;
            background-color: beige;
        }

        input[type="submit"] {
            background-color: green;
            padding:5px 17px;
            color:white;
            border-radius: 7px;
            margin: auto;
        }
        input[type="text"],input[type="number"]{
            padding: 5px;
        }
        .reply {
            padding:3px;
            text-align: center;
        }
        .right {
            padding: 7px;
            background-color: greenyellow;
            border: 1px solid green;
            margin:7px;
        }
        .wrong {
            padding: 7px;
            background-color: lightsalmon;
            border: 1px solid red;
            margin:7px;
        }
        .next,.ask-me {
            padding: 7px;
            margin: 7px;
            border:1px solid;
            background-color: #fac;
        }
        .newq {
            padding: 5px;
            font-size: 12px;
        }
        .result-wrap {
            border-bottom: 1px solid;
            background-color: black;
            color: greenyellow;
            padding: 3px;
            text-align: center;
        }
        .asking-que {
            width: 100%;
            height: 150px;
        }

    </style>
</head>
<body>

    <div class="container">
        <div class="header">
            <div class="result-wrap"> रिजल्ट: 
                <span class="result">0/0</span>
            </div>
        </div>
        <div class="reply">

        </div>        
        <form class="QnA">
            <div> नाम:
                <span class="username"></span>
            </div>
            <!-- <input type="text" class="username" name="username" required> -->
            <hr>
            <p>सवाल:</p>
            <h2 class="ques"></h2>
            <hr>
           
            <label for="ans"> उत्तर:</label>
            
            <input type="number" name="ans" class="ans" oninput='if(value.length>4){value="";badassAlert.show()};' required>
            <!-- <input type="hidden" class="hi"> -->
            <hr>
            <input type="submit" value="चेक करें">
            <button class="newq" hidden>नया सवाल</button>
        </form>

        <div class="footer">
            <div class="ask-me">सवाल पूछें</div>

        </div>
        <div class="examples">
            उदाहरण-
            <pre>
            1) 2+3 = 5
            2) -1-2 = -3
            3) -1+2 = 1
            4) -3+2 = -1</pre>
        </div>
    </div>
<script>
let username;
let question_attempted = 0;
let sahi_questions = 0;
let galat_questions = 0;
let sahi = ` <i class="fa fa-circle-check"></i> सही जवाब!  <i class="bi bi-emoji-sunglasses"></i> `;
let galat = ` <i class="fa fa-xmark"></i> गलत जवाब <i class="bi bi-emoji-dizzy"></i> `;
const badassAlert = new HwAlert({title:"बदमाशी मत करो।"});

function randomOperator() {
  return Math.random() < 0.5 ? '+' : '-';
}

function randomNumber(min, max) {
  return Math.floor(Math.random() * (max - min + 1)) + min;
}

function generateExpression() {
    let Operator = ['+', '-', '','-'][Math.floor(Math.random() * 4)];
  return (
    Operator  +
    randomNumber(0, 15) +
    randomOperator() +
    randomNumber(0, 15)
  );
}

var evalx;
var x;
function giveAquestion(){
    x=generateExpression();
    evalx = eval(x);
    $('.ques').text(x);
    $('.ans').val('');
    // console.log(x);
    // console.log(evalx);
    // console.log(x);
}
giveAquestion();
$('.newq').on('click',function(e){giveAquestion();
    e.preventDefault();
});

$('.QnA').on('submit',function(e){
    e.preventDefault();
    let ans, val,name;
    val = $('.ans').val();
    name = $('.username').val();
    if(evalx == val){
        ans = !0;
    }else{
        ans=!1;
    }

    const reply = hwapi('.reply').h('').get();
    question_attempted +=1;
    if(ans)$('.ans').val('');

    setTimeout(() => {
        if (ans){
            hwapi().c('right').h(sahi).a(reply);
            sahi_questions +=1;

            $('.ques').append('= '+val);
            setTimeout(() => {
                hwapi(reply).h('<div class="next">अगला सवाल <i class="bi bi-arrow-down-circle-fill"></i> </div>');
                giveAquestion();    
            }, 5000);
        } else {
            hwapi().c('wrong').h(galat).a(reply);
            galat_questions+=1;
        }
        let result = sahi_questions +' / '+ question_attempted        
        $('.result').text(result);
        sendlog(username,x,evalx,val,result);

    }, 200);

});
let a = new HwAlert({
    title:'आपका नाम:',
    message:`<form id="username"><input type="text" class="username" name="username" >
        <div class="hw-alert-buttons">
        <button>OK</button>
    </div></form>

    `,
    buttons:[],
    overlay:true
}).show();

let askd = new HwDialog({
    title:'',
    message:'<textarea class="asking-que" placeholder="यहाँ सवाल लिखें। "></textarea>',
    buttons:['भेजें','कैंसिल'],
    callback : i=>{
        if (i===0){
            sendquestion($('textarea.asking-que').val())
        }
        askd.hide();

    }
}).hide();
</script>   
<script>
$('#username .username').focus();   
$('#username').on('submit',function(e){
    e.preventDefault();
    username = $('input.username').val().trim();
    if(!username)a.show();
    $('span.username').text(username);

});
$('.ask-me').on('click',function(){
    askd.open();
    $('.asking-que').focus();
});

let phpUrl = "https://neetiindia.org/wp-content/plugins/HindiWeb/123/123.php";
function sendquestion(ques) {
    if(!ques.trim())return;
    $.ajax({
        type:'POST',
        url: phpUrl, 
        data :{
            asked : ques, name:username
        },
        success: function (response) {
            hwPanel('सवाल भेज दिया।');
            console.log(response)
        },
        error: function (err) {
            hwPanel('सवाल नहीं भेजा जा सका। कृपया अपना नेटवर्क चेक करें। ');
            console.log(err);
        }
    }); 

}
function sendlog(name,ques,solved,ans,result){
    $.ajax({
        type:'POST',
        url: phpUrl, 
        data : {log: 
            {name : name, ques : ques, '=':solved,ans:ans,result:result}
        },
        success: function (response) {
            // hwPanel('सवाल भेज दिया।');
        },
        error: function (err) {
            // hwPanel('सवाल नहीं भेजा जा सका। कृपया अपना नेटवर्क चेक करें। ');
            console.log(err);
        }
    }); 
    

}
</script>
<script>
    if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('service-worker.js')
      .then(registration => console.log(
      'App :', registration.active.state
      //'Service Worker registered with scope:',registration.scope
      ))
      .catch(error => console.error('Service Worker registration failed:', error));
    }
</script>
</body>
</html>